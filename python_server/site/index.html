<html>

<head></head>

<body>

    <script type="text/javascript">
        function ajax(url, method, callback, params = null) {
            var obj;
            try {
                obj = new XMLHttpRequest();
            } catch (e) {
                try {
                    obj = new ActiveXObject("Msxml2.XMLHTTP");
                } catch (e) {
                    try {
                        obj = new ActiveXObject("Microsoft.XMLHTTP");
                    } catch (e) {
                        alert("Your browser does not support Ajax.");
                        return false;
                    }
                }
            }
            obj.onreadystatechange = function () {
                if (obj.readyState == 4) {
                    callback(obj);
                }
            }
            obj.open(method, url, true);
            obj.send(params);
            return obj;
        }


        function load() {
            ajax("/api/movies", "get", (obj) => {
                console.log(obj)
            })
        }

        function getState() {
            ajax("/api/state", "get", (obj) => {
                const data = JSON.parse(obj.responseText)
                document.getElementById("num-entries").innerHTML = data.entry_count
                document.getElementById("state").innerHTML = data.state

                if (data.state === "STARTED") {
                    // load()
                }
            })
        }

        setInterval(() => {
            getState()
        }, 1000)


    </script>
    <p>State <span id="state"></span></p>
    <p>Entries <span id="num-entries"></span></p>

</body>

</html>